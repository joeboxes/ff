<html>
<head>
	<title>Binary Math Testing</title>
</head>
	<script type="text/javascript" src="classes/Code.js"></script>
	<script type="text/javascript" src="classes/ByteData.js"></script>
	<script type="text/javascript" src="classes/BinInt.js"></script>
	<script type="text/javascript" src="classes/BinFast.js"></script>
	<script type="text/javascript">
	// -------------------------------------------------------------
	var logDiv = null;
	var realLog = false;
	log = function(str){
		//if(realLog){
			logDiv.innerHTML = logDiv.innerHTML + str + "\n";
		//}
	}
	handlePageLoadedFunction = function(e){
		logDiv = document.getElementById("logDiv"); logDiv.innerHTML = "";
		meat();
	}
	// ---------------------------------------------------------------------------
	function meat(){
		var str, i, len, prime, ret, val, t1, t2, dt, avg, count;
		var num = 256;//16384;
		var ba = new BinInt(num);
		var bb = new BinInt(num);
		var bc = new BinInt(num);
		var bd = new BinInt(num);
		var a = new BinFast(num);
		var b = new BinFast(num);
		var c = new BinFast(num);
		var d = new BinFast(num);
	// log("------------------------------------------------------------------------------------------ PROPERTIES");
	// log( "bitCount: " + a.bitCount() );
	// log( "length: " + a.length() );
	// log( "isNegative: " + a.isNegative() );
	// a.randomize();
	// log( "randomized: " + a.toString() );
	// str = "1010010";
	// log( "string value: " + str );
	// a.setFromString(str);
	// log("applied value: " + a.toString());
	// log( "string10 value: " + a.toString10() );
	// i = 1234567;
	// a.setFromInt(i);
	// log( "integer value: " + i );
	// log("applied value: " + a.toString());
	// log("javascript int: " + a.getIntValue());
	// log("------------------------------------------------------------------------------------------ NOT");
	// a.randomize(); b.randomize(); BinFast.not(c,a);
	// log(" not " + a.toString() );
	// log("  =  " + c.toString() );
	// log("------------------------------------------------------------------------------------------ AND");
	// a.randomize(); b.randomize(); BinFast.and(c,a,b);
	// log("     " + a.toString() );
	// log(" and " + b.toString() );
	// log("  =  " + c.toString() );
	// log("------------------------------------------------------------------------------------------ OR");
	// a.randomize(); b.randomize(); BinFast.or(c,a,b);
	// log("     " + a.toString() );
	// log("  or " + b.toString() );
	// log("  =  " + c.toString() );
	// log("------------------------------------------------------------------------------------------ XOR");
	// a.randomize(); b.randomize(); BinFast.xor(c,a,b);
	// log("     " + a.toString() );
	// log(" xor " + b.toString() );
	// log("  =  " + c.toString() );
	// log("------------------------------------------------------------------------------------------ ADDITION");
	// // a.setFromInt(22); b.setFromInt(98);
	// a.randomize(); b.randomize(); BinFast.add(c,a,b);
	// log("     " + a.toString() );
	// log("  +  " + b.toString() );
	// log("  =  " + c.toString() );
	// log("------------------------------------------------------------------------------------------ SUBTRACTION");
	// // a.setFromInt(22); b.setFromInt(78);
	// a.randomize(); b.randomize(); BinFast.sub(c,a,b);
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  -  " + b.toString() + " [" + b.toString10() + "]" );
	// log("  =  " + c.toString() + " [" + c.toString10() + "]" );
	// log("------------------------------------------------------------------------------------------ MULTIPLICATION");
	// a.randomize(); a.maskHigh(); b.randomize(); b.maskHigh(); BinFast.mul(c,a,b); //a.setFromInt(31345); b.setFromInt(53213);
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  *  " + b.toString() + " [" + b.toString10() + "]" );
	// log("  =  " + c.toString() + " [" + c.toString10() + "]" );
	// log("------------------------------------------------------------------------------------------ DIVISION + MODULUS");
	// //a.setFromInt(345); b.setFromInt(6);
	// a.randomize(); b.randomize(); 
	// BinFast.rem(d,c,a,b);
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  /% " + b.toString() + " [" + b.toString10() + "]" );
	// log("  =  " + c.toString() + " [" + c.toString10() + "]" );
	// log("  r  " + d.toString() + " [" + d.toString10() + "]" );
	// log("------------------------------------------------------------------------------------------ DIVISION");
	//  // a.randomize(); b.randomize(); 
	// BinFast.div(c,a,b);
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  /  " + b.toString() + " [" + b.toString10() + "]" );
	// log("  =  " + c.toString() + " [" + c.toString10() + "]" );
	// log("------------------------------------------------------------------------------------------ MODULUS");
	//  // a.randomize(); b.randomize(); 
	// BinFast.mod(c,a,b);
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  %  " + b.toString() + " [" + b.toString10() + "]" );
	// log("  =  " + c.toString() + " [" + c.toString10() + "]" );
	// log("------------------------------------------------------------------------------------------ GT");
	// a.randomize(); b.randomize();
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  gt " + b.toString() + " [" + b.toString10() + "]" );
	// log("  =  " + BinFast.gt(a,b) );
	// log("------------------------------------------------------------------------------------------ GE");
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  ge " + b.toString() + " [" + b.toString10() + "]" );
	// log("  =  " + BinFast.ge(a,b) );
	// log("------------------------------------------------------------------------------------------ LE");
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  le " + b.toString() + " [" + b.toString10() + "]" );
	// log("  =  " + BinFast.le(a,b) );
	// log("------------------------------------------------------------------------------------------ LT");
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  lt " + b.toString() + " [" + b.toString10() + "]" );
	// log("  =  " + BinFast.lt(a,b) );
	// log("------------------------------------------------------------------------------------------ EQ");
	// //a.setFromInt(345); b.setFromInt(345);
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  eq " + b.toString() + " [" + b.toString10() + "]" );
	// log("  =  " + BinFast.eq(a,b) );
	// log("------------------------------------------------------------------------------------------ NE");
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  ne " + b.toString() + " [" + b.toString10() + "]" );
	// log("  =  " + BinFast.ne(a,b) );
	// log("------------------------------------------------------------------------------------------ POWER + MODULUS");
	// //a.setFromInt(12345); b.setFromInt(89); d.setFromInt(655025);
	// //a.setFromInt(1234); b.setFromInt(100); d.setFromInt(99988877);
	// BinFast.pow(c, a,b,d);
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  ^  " + b.toString() + " [" + b.toString10() + "]" );
	// log("  %  " + d.toString() + " [" + d.toString10() + "]" );
	// log("  =  " + c.toString() + " [" + c.toString10() + "]" );
	// log("------------------------------------------------------------------------------------------ POWER");
	// BinFast.pow(c, a,b);
	// log("     " + a.toString() + " [" + a.toString10() + "]" );
	// log("  ^  " + b.toString() + " [" + b.toString10() + "]" );
	// log("  =  " + c.toString() + " [" + c.toString10() + "]" );
	// log("------------------------------------------------------------------------------------------ MILLER-RABIN-PRIME");
	//1234567891;//1234567801;//104729;//18301;
	// a.randomize();//a.setFromInt(619095313);//a.randomize(); a.odd();
	// ret = BinFast.millerRabinPrime(a);
	// log("        " + a.toString() + " [" + a.toString10() + "]" );
	// log(" prime: " + ret );
	// str = a.toStringSimple(); ba.setFromString(str);
	// ret = BinInt.millerRabinPrime(ba);
	// log("        " + ba.toString() + " [" + ba.toString10() + "]" );
	// log(" prime: " + ret );
	// log("          " + str);
	// log("------------------------------------------------------------------------------------------ RANDOM-PRIME");
	// ret = BinFast.randomPrime(a);
	// log(" prime " + a.toString() + " [" + a.toString10() + "] (" + ret + ")" );
log( 559376679479112.0+2.0 );

return;
log(num+" bits");
avg = 0;
len = 1;
for(i=0;i<len;++i){
	t1 = Code.getTimeMilliseconds();
	ret = BinFast.randomPrime(a);
	t2 = Code.getTimeMilliseconds();
	dt = t2-t1;
	avg += dt;
	log(a.toString10() + "           " + ret);
	log((dt/60.0) + " seconds");
}
avg /= len;
log((avg/60.0) + " average seconds");
return;
/*
32:  2, 3, 5
64:  54, 58, 70
128: 550, 937, 1550
256: 13855
*/

	log("------------------------------------------------------------------------------------------ DIFFIE-HELLMAN");

num = 256;
var P = new BinFast(num, false);
var G = new BinFast(num, false);
var Apri = new BinFast(num, false);
var Apub = new BinFast(num, false);
var Bpri = new BinFast(num, false);
var Bpub = new BinFast(num, false);
var Sa = new BinFast(num, false);
var Sb = new BinFast(num, false);
// 1
log("STEP 1:");
//BinFast.diffieHellmanPublic(P,G, true);
P.setFromInt(23);
G.setFromInt(5);
log( "MODULUS:   "+ P.toString() +" ("+ P.toString10() +")" );
log( "BASE:      "+ G.toString() +" ("+ G.toString10() +")" );
// 2
log("STEP 2:");
//BinFast.diffieHellmanPrivate(Apri,Apub, P,G);
Apri.setFromInt(6);
BinFast.pow(Apub, G,Apri, P);
log( "ALICE-PRI: "+ Apri.toString() +" ("+ Apri.toString10() +")" );
log( "ALICE-PUB: "+ Apub.toString() +" ("+ Apub.toString10() +")" );
//BinFast.diffieHellmanPrivate(Bpri,Bpub, P,G);
Bpri.setFromInt(15);
BinFast.pow(Bpub, G,Bpri, P);
log( "BOB-PRI:   "+ Bpri.toString() +" ("+ Bpri.toString10() +")" );
log( "BOB-PUB:   "+ Bpub.toString() +" ("+ Bpub.toString10() +")" );
// 3
log("STEP 3:");
BinFast.diffieHellmanSecret(Sa, Apri,Bpub,P);
BinFast.diffieHellmanSecret(Sb, Bpri,Apub,P);
log( "ALICE-SEC: "+ Sa.toString() +" ("+ Sa.toString10() +")" );
log( "BOB-SEC:   "+ Sb.toString() +" ("+ Sb.toString10() +")" );
return;
	log("------------------------------------------------------------------------------------------ RSA");
	log("------------------------------------------------------------------------------------------ ");
	log("------------------------------------------------------------------------------------------ ABS");
	log("------------------------------------------------------------------------------------------ NEG");
	log("------------------------------------------------------------------------------------------ ");
	//
	//log(a.toString10());
return;

 		console.log( a.toString() );
 		console.log( ba.toString() );
//return;
		console.log( b.toString() );
		console.log( bb.toString() );
		// console.log( d.toString() );
		// console.log( bd.toString() );
		console.log( c.toString() );
		console.log( bc.toString() );
		// 
		return;
	}
	</script>
<body onload="handlePageLoadedFunction();">
	<div id="logDiv" style="font-size:10px; white-space: pre; font-family: monospace; display:block; background-color:#EEE; padding:5px; margin:0; border: none;"><div>
</body>
</html>