<html>
<head>
<title>Features / Matching</title>
<script src="../code/FF.js"></script>
</head>
<script type="text/javascript">
function pageLoadedFxn(){
	var ff = new FF("../../code/",ffLoadedFxn);
}
function ffLoadedFxn(){
	(new ScriptLoader("./",["PointMatch.js","LineOrder.js","DualOrder.js","R3D.js","View3DR.js","Link3DR.js","Scene3DR.js","PointCloud.js",
		"ColorFloat.js","ColorAngle.js","ColorGradient.js","ColorMatRGBY.js","GradBinDescriptor.js","SIFTDescriptor.js","ColorMatRGBY.js","ImageFeature.js","ImageDescriptor.js","ImageMatcher.js","FeatureTest.js"],this,classesLoadedFxn)).load();
}
function classesLoadedFxn(){
/*
	var points = [];
		points.push(new V2D(0,0));
		points.push(new V2D(0,1));
		points.push(new V2D(1,2));
		points.push(new V2D(2,1));
		points.push(new V2D(2.5,0));
		points.push(new V2D(-1,-1));
		//points.push(new V2D(1,-1));
	console.log("POINTS");
	console.log(points);
	console.log("HULL");
	var hull = Code.convexHull(points);
	console.log(hull);
	console.log("MAR");
	var mar = Code.minRect(hull);
	console.log(mar);

	return;
*/
/*
	var uf = new UnionFind();
	var s1 = uf.newSet();

console.log(uf);
console.log(s1);

	return;
*/



	var features = new FeatureTest();
	return;

var a = [1.171363878968783, 0.013877909973027156, 0.03884755420317247, 0.32626487295571016, 0.7877497467896601, 0, 0.04407590059487167, 0.5189962959809866];
var b = Code.copyArray(a);
console.log(a);
console.log(b);
var c = Code.arrayVectorSub(a,b);
	// Code.arrayVectorSub = function(a,b){
	// var c = Code.newArray(a.length);
	// for(var i=a.length; --i; ){
	// 	c[i] = a[i] - b[i];
	// }
	// return c;

console.log(c);

return;


var mask = R3D.circularSIFTBinMask(3);
console.log(mask);
var width = mask["width"];
var height = mask["height"];
var mask = mask["value"];
console.log(mask);
// array2DtoString
 console.log( Code.array1Das2DtoString(mask,width,height, 0) );
//console.log( Code.array2DtoString(mask,width,height) );


return;

	/*
	var points = [];
	var a = 5;
	var b = 2;
	var c = 3;
	var samples = 4;
	for(var i=0; i<samples; ++i){
		var x = 0 + i;
		var y = a*x*x + b*x + c;
		points.push(new V2D(x,y));
	}
	// points.push(new V2D(0,0));
	// points.push(new V2D(1,1));
	// points.push(new V2D(2,4));
	// points.push(new V2D(3,9));
	// points.push(new V2D(4,16));
	var parabola = Code.parabolaAlgebraic(points);
	console.log(parabola);

	a = parabola["a"];
	b = parabola["b"];
	c = parabola["c"];

	var i = 2;
	var p = points[i];
	y = p.x*p.x*a + b*p.x + c;
	console.log(y,p.y)
	return;
	*/

// testing polynomial root finding
//                   0, 1, 2, 3, 4
//var coefficients = [-7, 1,-7, 2, 2];
//var coefficients = [ 0,-7, 1,-7, 2, 2];
//var coefficients = [ 10, -140, -270, 0, 10];
var coefficients = [ 1E-8, -140, 270, 0, 10];
console.log(coefficients);
var roots = R3D.polynomialRoots(coefficients);
console.log(roots);

var r, x, i, j, k, sum;
for(i=0;i<roots.length;++i){
	x = roots[i];
	sum = 0.0;
	for(j=0;j<coefficients.length;++j){
		v = coefficients[j];
		for(k=0;k<j;++k){
			v *= x;
		}
		sum += v;
	}
	console.log(i+": ("+x+") = "+sum);
}

/*
-4.91
-0.589
0.064
5.435


Real roots:
Root 1:
Root 2:
Complex roots:
Root 3:
Root 4:

0
0.514

-0.257-i*5.215
-0.257+i*5.215


*/
/*

R3D.js:984 [-0.03655813741072811, -0.03655813741072811, 0.5990130384951929, -0.3830396208165937]
features.html:23 [-27.353691156775035, -27.353691156775035, 1.669412743522485, -2.61069598457758]
   1.4286E-1 -1.0000E+0  2.8571E-1  2.8571E-1 ;
   1.0000E+0  0.0000E+0  0.0000E+0  0.0000E+0 ;
   0.0000E+0  1.0000E+0  0.0000E+0  0.0000E+0 ;
   0.0000E+0  0.0000E+0  1.0000E+0  0.0000E+0 ;

   A = [1.4286E-1 -1.0000E+0  2.8571E-1  2.8571E-1 ;
   1.0000E+0  0.0000E+0  0.0000E+0  0.0000E+0 ;
   0.0000E+0  1.0000E+0  0.0000E+0  0.0000E+0 ;
   0.0000E+0  0.0000E+0  1.0000E+0  0.0000E+0 ]
   eig(A)

*/
return;

// testing cubic solutions
// var a = 2;
// var b = -4;
// var c = -22;
// var d = 24;

// var a = 2;
// var b = 4;
// var c = 22;
// var d = 24;

// var a = 2;
// var b = -2;
// var c = -2;
// var d = 2;

// var a = -9;
// var b = 27;
// var c = 3;
// var d = -27;

// var a = -1;
// var b = 0;
// var c = 0;
// var d = -1;

// var a = 1;
// var b = 0;
// var c = 0;
// var d = 0;

// var a = 0;
// var b = 1;
// var c = 0;
// var d = -2;

// var a = 0;
// var b = 0;
// var c = 4;
// var d = 2;

var soln = Code.cubicSolution(a,b,c,d);
console.log(a,b,c,d);
console.log(soln);
	return;

// testing randomizing arrays
	var arr = [0,1,2,3,4,5];
	//var arr = [0,1,2];
	console.log(arr);
	//Code.randomizeArray(arr);//Code.randomizeArray(arr, true);
	//console.log(arr);
	console.log( Code._randomSubsetNoScale([], 3, arr) );
	console.log( Code.randomSubsetFromArray([], 3, arr) );
	return;

// difference of gaussian experiments
	var i, j, k, len, index;
	var width = 10;
	var height = 10;
	var size = width*height;
	var mat = new Array(size);
	for(j=0;j<height;++j){//
		for(i=0;i<width;++i){//
			index = j*width + i;
			mat[index] = 0;
		}
	}

	j = 4; i = 4; index = j*width + i; mat[index] = 1.0;

	//var source = new ImageMat(width,height,mat,mat,mat);
	var source = Code.copyArray(mat);

	var sigmaA = 1.6;
	var gauss1DA = ImageMat.gaussianWindow1DFromSigma(sigmaA);
	var gaussedA = ImageMat.gaussian2DFrom1DFloat(source, width,height, gauss1DA);

	var sigmaB = 1.6*1.6;
	var gauss1DB = ImageMat.gaussianWindow1DFromSigma(sigmaB);
	var gaussedB = ImageMat.gaussian2DFrom1DFloat(source, width,height, gauss1DB);

	var gaussedC = ImageMat.gaussian2DFrom1DFloat(gaussedA, width,height, gauss1DA);

	var gaussDiffAB = ImageMat.subFloat(gaussedA,gaussedB);
	var gaussDiffAC = ImageMat.subFloat(gaussedA,gaussedC);
	var gaussDiffBC = ImageMat.subFloat(gaussedB,gaussedC);

	console.log( "SOURCE:" );
	console.log( Code.array1Das2DtoString(source, width,height) );

console.log( ImageMat.sumFloat(gauss1DA) );
console.log( ImageMat.sumFloat(gauss1DB) );

	console.log( "A:" );
	console.log( Code.array1Das2DtoString(gaussedA, width,height) );

	console.log( "B:" );
	console.log( Code.array1Das2DtoString(gaussedB, width,height) );

	console.log( "C:" );
	console.log( Code.array1Das2DtoString(gaussedC, width,height) );

	console.log( "DIFF AB:" );
	console.log( Code.array1Das2DtoString(gaussDiffAB, width,height) );

	console.log( "DIFF AC:" );
	console.log( Code.array1Das2DtoString(gaussDiffAC, width,height) );

	console.log( "DIFF BC:" );
	console.log( Code.array1Das2DtoString(gaussDiffBC, width,height) );

	return;




// this shows extrema being outside of detection location

 var a = [-0.0031704982880084165,-0.004274601809128087,-0.005458226613662687,-0.0032523236377163256,-0.004429873179193189,-0.005667577234607646,-0.0033301012220670057,-0.00451968302981931,-0.005741803285186697]
 var b = [-0.005663115438903743,-0.00620459315123556,-0.005982045323666307,-0.005719663932825081,-0.00626065504612372,-0.006031585608448964,-0.005702442428397236,-0.006216345396295231,-0.0059509564461344144];
 var c = [-0.004141515460750589,-0.002727052230286131,-0.0004163081232491095,-0.0041551986148183895,-0.0027360967768288447,-0.0004271178699614131,-0.004110595368775005,-0.0026828401635838883,-0.0003763682806563473];
// var a = [3, 4, 5,   3, 4, 6,   3, 4, 6];
// var b = [6, 6, 6,   6, 6, 6,   5, 6, 6];
// var c = [4, 3, 4,   4, 3, 4,   4, 3, 4];

var a0 = a[0];
var a1 = a[1];
var a2 = a[2];
var a3 = a[3];
var a4 = a[4];
var a5 = a[5];
var a6 = a[6];
var a7 = a[7];
var a8 = a[8];

var b0 = b[0];
var b1 = b[1];
var b2 = b[2];
var b3 = b[3];
var b4 = b[4];
var b5 = b[5];
var b6 = b[6];
var b7 = b[7];
var b8 = b[8];

var c0 = c[0];
var c1 = c[1];
var c2 = c[2];
var c3 = c[3];
var c4 = c[4];
var c5 = c[5];
var c6 = c[6];
var c7 = c[7];
var c8 = c[8];


var result = Code.extrema3DInterpolate(new V4D(),a1,a3,a4,a5,a7, b0,b1,b2,b3,b4,b5,b6,b7,b8, c1,c3,c4,c5,c7);
console.log(result+" ");

//  <1.2120615051121373,0.2124443863668512,-0.5086096462210309,-0.006571164038850714>


}
</script>
<body onload="pageLoadedFxn();">
</body>
</html>
