% surfD.m









% start
hold off;
del = 0.1; 









countX = 11;
countY = 11;
x = [0.007873102875208315,0.010971790082773006,0.014635521988228532,0.018669689873665945,0.022879685021176287,0.027070898712850594,0.03104872223077993,0.03461854685705532,0.037585763873767844,0.03975576456300851,0.040933940206868386,0.011162813303028856,0.014245624345904252,0.017952113522383423,0.022087672114557436,0.026457691404517328,0.030867562674354143,0.03512267720615894,0.03902842628202274,0.04239020118403663,0.04501339319429161,0.04670339359487876,0.014388112213194772,0.01738984510540641,0.02107388956693479,0.025245636879870956,0.029710478326305953,0.03427380518833083,0.03874100874803664,0.04291748028751441,0.04660861108885521,0.049619792434150066,0.05175641560549003,0.017635772308628624,0.020491225064202066,0.024087622824805196,0.02823035687252907,0.03272481848946473,0.03737639895770322,0.04199048955933559,0.046372481576452886,0.05032776629114616,0.05366173498550644,0.05617977894162479,0.020992566292252976,0.023636536925213773,0.027080085998917213,0.031128604795454345,0.03558748459691622,0.04026211668539388,0.044957892342978374,0.04948020285176074,0.05363443949383204,0.0572259935512833,0.060060256306205574,0.024545266866990392,0.0269125533913641,0.030138051792193404,0.034027153351569354,0.038385249351582995,0.043017731074325376,0.04772998980188754,0.052327416816360536,0.05661540339983541,0.0603993408344032,0.06348462040215497,0.028380646735763446,0.030406047165575614,0.03334829290755634,0.037012775243796654,0.04120488545638762,0.04573001482742027,0.05039355463898566,0.055000896173174836,0.05935743071207884,0.06326854953778872,0.06653964393239553,0.0325854786014947,0.03420379095077088,0.03679758204792857,0.04017224317505881,0.04413316561425265,0.04848574064760113,0.05303535955719531,0.05758741362512621,0.06194729413348491,0.06592039236436242,0.06931209959984982,0.037246535167106715,0.038392557449872466,0.04057269191623268,0.0435923298482784,0.047256862528100664,0.051371681237790526,0.05574217725943903,0.06017374187513723,0.06447176636697616,0.06844164201704687,0.07188876010744041,0.04245058913552206,0.043059119365802936,0.04476039521539123,0.047359807966377974,0.050662748900854225,0.05447460930091102,0.05860078044863942,0.06284665362613046,0.06701762011547518,0.07091907119876464,0.07435639815808989,0.048284413209663306,0.04829024940148486,0.04944746464832678,0.05156145023228011,0.05443759743543589,0.057881297539885176,0.06169794182771901,0.06569292158102844,0.06967162808190452,0.07343945261243828,0.07680178645472077];
y = [0.18112821809952187,0.1874637250747648,0.19242248490200387,0.19647866714403278,0.20010644136364542,0.2037799771236355,0.20797344398679685,0.21316101151592326,0.21981684927380854,0.22841512682324647,0.23943001372703085,0.1776547509389825,0.18402894063178538,0.18888352117699952,0.19269266213741876,0.19593053307583685,0.19907130355504765,0.2025891431378449,0.20695822138702238,0.21265270786537394,0.2201467721356933,0.22991458376077434,0.17433822423565054,0.18090996310130367,0.18581923081978324,0.18954019695388313,0.19254703106639706,0.19531390272011884,0.1983149814778423,0.2020244369023612,0.20691643855646932,0.2134651560029605,0.2221447588046285,0.17096721388145253,0.1778953683752462,0.18301818972228157,0.18680984748535237,0.18974451122725244,0.1922963505107756,0.19493953489871557,0.1981482339538662,0.20239661723902125,0.20815885431697453,0.21590911475051983,0.1673302957683149,0.17477373234553947,0.1802689737764209,0.18429018962375301,0.18731154945032957,0.18980722281894435,0.1922513792923912,0.19511818843346387,0.19888181980495617,0.2040164429696619,0.21099622749037483,0.16321604578816418,0.17133363090410997,0.17736015887412782,0.18176979926101153,0.18503672162755488,0.18763509553655167,0.19003909055079568,0.19272287623308074,0.19616062214620061,0.2008264978529491,0.20719467291611995,0.15841303983292687,0.1673636399428842,0.17408032090732878,0.17903725228905443,0.1827086036508549,0.185568544555524,0.18809124456585552,0.19075087324464327,0.19402160015468103,0.1983775948587626,0.20429302691968176,0.15270985379452945,0.16265233535378865,0.1702180357679503,0.1758811245998082,0.18011577141215612,0.18339614576778784,0.18619641722949723,0.18899075536007798,0.19225332972232398,0.19645830987902896,0.20207986539298672,0.14589506356489843,0.15698829302874984,0.16556187934791886,0.17208999208519932,0.17704680080338503,0.18090647506526975,0.18414318443364724,0.18723109847131136,0.1906443867410559,0.1948572188056746,0.2003437642279613,0.1377572450359603,0.1501600888596942,0.15990042753916095,0.16745243063715431,0.1732902677164681,0.17788810833989613,0.18172012207023214,0.1852604784702699,0.18898334710280332,0.19336289753062608,0.19887329931653203,0.12808497409964154,0.1419562987385483,0.1530222562336031,0.16175701614759969,0.1686347480433319,0.1741296214835935,0.17871580603117834,0.18286747124888014,0.18705878669949272,0.19176392194580988,0.1974570465506254];
z = [-0.803820347142879,-0.7990791916343619,-0.7974286371341995,-0.7978042405955866,-0.799141558971718,-0.8003761492157887,-0.8004435682809933,-0.7982793731205269,-0.7928191206875842,-0.78299836793536,-0.7677526718170493,-0.8034024627754243,-0.7985744700825558,-0.7971577832134559,-0.7980879591213196,-0.8003005547593416,-0.8027311270807168,-0.80431523303864,-0.8039884295863062,-0.8006862736769101,-0.7933443222636467,-0.7808981322997107,-0.8026322694629319,-0.7973608070496461,-0.795821355275543,-0.7969494710938174,-0.7996807114576642,-0.8029506333202782,-0.8056947936348542,-0.8068487493545872,-0.805348057432672,-0.8001282748223033,-0.7901249584766762,-0.8019843841766808,-0.7959128195069118,-0.7938939702917397,-0.794863393484359,-0.7977566460379647,-0.8015092849057517,-0.8050568670409147,-0.8073349493966487,-0.8072790889261485,-0.8038248425826089,-0.7959077673192249,-0.8019334238879497,-0.7947051244256319,-0.7918502452333248,-0.7923043432642233,-0.7950029754715221,-0.7988816988084162,-0.8028760702281005,-0.8059216466837696,-0.8069539851286186,-0.8049086425158423,-0.7987211757986354,-0.8029540055680177,-0.7942123387770851,-0.7901647970715773,-0.789746937404689,-0.7918943167296153,-0.7955424919995507,-0.7996270201676903,-0.8030834581872288,-0.8048473630113612,-0.8038542915932823,-0.7990398008861869,-0.8055207461881634,-0.7949090795325504,-0.789312242777776,-0.7876657928770353,-0.788905286783523,-0.791966281450434,-0.7957843338309631,-0.7992950008783052,-0.8014338395456552,-0.8011364067862078,-0.797338259553158,-0.810108262719666,-0.7972699636633065,-0.7897671993231998,-0.7865355266525408,-0.7865105026045242,-0.788627684132345,-0.7918226281891978,-0.7950308917282777,-0.7971880317027794,-0.7972296050658978,-0.7940911687708277,-0.8171911721338041,-0.8017696081406325,-0.7920042836791277,-0.7868307557024845,-0.7851845811638978,-0.7860013170165624,-0.7882165202136732,-0.790765747708425,-0.7925845564540127,-0.7926085034036311,-0.7897731455104751,-0.8272440914018567,-0.8088826299358072,-0.7964981128168384,-0.7890260969981453,-0.7854021394329227,-0.7845617970743654,-0.7854406268756683,-0.7869741857900262,-0.788098030770634,-0.7877477187706866,-0.7848588067433787,-0.8407416374951028,-0.8190836460201094,-0.8037233037076109,-0.793596167510802,-0.7876377943828776,-0.7847837412770327,-0.7839695651464618,-0.7841308229443601,-0.7842030716239222,-0.7831218681383432,-0.7798227694408176];
px = [0.02124801786224007,0.015923437499191447,0.01673020377739181,0.019348855186207204,0.02119660266718945,0.0167225060808138,0.02282759912129795,0.02661281360243261,0.027092732861321585,0.02564360377166057,0.01682050011911906,0.01651863551785961,0.0298864979055139,0.03532885003408687,0.042979924135992095,0.03237082431116576,0.04355724595095435,0.04218375636618939,0.03240101723268658,0.0387401697709016,0.05006045882497317,0.051187327741865324,0.053187656169692225,0.047526182460327554,0.048135547296703565,0.0510744320114202,0.056235730728507315,0.05687494495568226,0.05780326315162113,0.06121435999899104,0.060035787889923434,0.03241692543414097,0.04764087258566553,0.014833249953977688,0.018999705743084117,0.027616169905216918,0.02634522781060142,0.020845156197234014,0.021306397035247036,0.02867741865843524,0.025782777493976075,0.02327912253547685,0.025730532852278727,0.03706032636400436,0.03215775772855007,0.038854107526755,0.03778495409750901,0.032970156329490394,0.04649643296745396,0.04587173041174208,0.04242553891723216,0.04270966362473187,0.04528698235798752,0.03987061667242476,0.04330560456988526,0.044266330021591235,0.034538560588820134,0.03843243938459595,0.03155014884913899,0.04659134237379249,0.0326206335088525,0.036930176462231235,0.048676002591952136,0.052662974715628225,0.051630503999585076,0.05335499541701185,0.053779936757386224,0.05506548966527301,0.057490940695061506,0.05902275851646063,0.05510254198429514,0.0573123064243273,0.05494022862131537,0.06125655701352982,0.05058656835306717,0.05167233232018858,0.0604570080225673,0.057336057980161566,0.048940263002352546,0.049062561054778964,0.05792052525043749,0.05576287284069294,0.05672791006153477,0.055678810018468194,0.041520175722729764,0.06603784871817066,0.069367832724488,0.06381217306352374,0.06419313118979231,0.06412837193674249,0.06618650903418281,0.06632590052118885,0.06668794161509732,0.06927779667290475,0.06345056802409699,0.06899454175537675,0.06818140037683489,0.07246361637000012,0.06413326292573873,0.06641013197670759];
py = [0.17345380265707167,0.17334876500935187,0.1767422347358849,0.1873004148854765,0.18309261254647133,0.18304906836334855,0.18368674102367752,0.1749433730775672,0.18024570315720667,0.18534699370753058,0.17957356891329113,0.18369295553740553,0.1777150060170557,0.16968034632108725,0.16651565866856746,0.18599907343801586,0.18385869033512567,0.1834648588710674,0.1792008687404082,0.17895702744529865,0.16742061106496017,0.18373918899942351,0.17965210223082703,0.17213567054004109,0.18563958580412718,0.1831681329262402,0.18331624749870362,0.18354220394154772,0.18466360290832495,0.18155606129357768,0.1839214758685932,0.18515197015913307,0.18046209094787158,0.19021885360224997,0.18801267451581488,0.19521168088097793,0.19020719471473205,0.19250628344454096,0.19421489459111238,0.20259152463255548,0.20636687079659596,0.1956660414860331,0.19035909248739105,0.18952337403095196,0.19189876088047836,0.18976983075451026,0.20173690453457518,0.2026623574096758,0.19018107623292282,0.19422225109399188,0.1928688315830745,0.19707181537098784,0.19873036848380424,0.20235095336919212,0.1991240933307674,0.19120860674670173,0.20770634818615724,0.2061173817849252,0.20402305654778835,0.2070707354264978,0.20880962759424807,0.21179855880280654,0.1950489771603484,0.18918017645458313,0.19235233118627526,0.19832542110888135,0.2016228920966852,0.19514110830139805,0.1898495600866123,0.19025238351370743,0.1983305369278687,0.20191006006512838,0.20114837754687048,0.20110341352531017,0.18922958352372554,0.19086713113593368,0.18809462224507256,0.18750736461023673,0.20476385231183566,0.20646301445250112,0.20681595969659594,0.20749532845017019,0.20577669104155522,0.21098135851155683,0.19175133301621844,0.18671932521663162,0.18667874561487674,0.19406947140022188,0.20044848612637983,0.20188025902215245,0.20296745754033993,0.19173006281110688,0.19332790076920706,0.19212808727860775,0.18811564743637038,0.18987745455227065,0.19607141998163682,0.19105504803978035,0.20482927972348877,0.20510632492415654];
pz = [-0.8073555741248478,-0.7998768793092998,-0.7993555361013308,-0.8054315480967453,-0.8089794489901486,-0.7987229190409195,-0.8022203324108325,-0.8000392909239001,-0.7990609503692256,-0.7990130415781488,-0.7886552850569567,-0.7912403993798707,-0.7890868078326481,-0.7994302283995441,-0.7897954037028275,-0.8010387364902068,-0.8111969908212899,-0.8005405432031641,-0.7931032619181669,-0.7908765972358465,-0.7898435118121466,-0.803324069370005,-0.7913412139501338,-0.7869900880522256,-0.7813765233988821,-0.78702102532966,-0.7909548261568524,-0.7905070495252269,-0.7865204486634676,-0.7867335636426165,-0.7887877501402971,-0.7799436727182942,-0.777810161031491,-0.7933054222000405,-0.7977407746052106,-0.8081324614605719,-0.8029155983200091,-0.7901574503340946,-0.7873344717563153,-0.7959471645097527,-0.7941922713765328,-0.77828650860802,-0.7758337178976147,-0.8112689407497747,-0.7996519074857504,-0.8008965451405085,-0.8111985551500344,-0.802088195584409,-0.8054168464164075,-0.8073724295000271,-0.8046046721336108,-0.80563838280544,-0.8113187820317359,-0.7994857041978597,-0.8010070444842652,-0.7884358904464573,-0.8057543479330299,-0.8099231256624995,-0.79972243488864,-0.8057658965572329,-0.7952652210471763,-0.7917258894253748,-0.8071977370483331,-0.8090167800558246,-0.8018130071868728,-0.8007392907972106,-0.8010540246229266,-0.8078418402159929,-0.8020523578892166,-0.7984530448517687,-0.8081727934413485,-0.8091685774004664,-0.8067203310875647,-0.8066327100736399,-0.7912471767679218,-0.7967440488045181,-0.7929443567207949,-0.7818735323520488,-0.8094065388882715,-0.8057277495686834,-0.8052298882988546,-0.8069722336008485,-0.800086191889877,-0.794119927360309,-0.7800175354306733,-0.7906610321855131,-0.7842912966437741,-0.7989076766640121,-0.8043987998518611,-0.7992761030879528,-0.7986039805444675,-0.7918369780312509,-0.7909836366479531,-0.7898847095914976,-0.7886564042209687,-0.7844212686267159,-0.7933453418849158,-0.7859476847020872,-0.798225319061496,-0.7946122399186247];

% original point 
ox =0.05006045882497319;
oy =0.1674206110649602;
oz =-0.7898435118121465;
% projected point 
fx =0.04164411400980272;
fy =0.17050861569873357;
fz =-0.7880840320768773;
% local plane normal 
nx =0.16472470311520077;
ny =-0.40135632820937706;
nz =-0.9009877191115845;

% surface normal 
sx =0.21161965016493706;
sy =0.48869031672080954;
sz =-0.8464035077948253;
curvature = 122.17446121099019;



















tx = reshape(x, countX,countY);
ty = reshape(y, countX,countY);
tz = reshape(z, countX,countY);

mesh(tx, ty, tz);

hold on;
% neighborhood points
plot3(px,py,pz, 'r*');
% original point
plot3(ox,oy,oz, 'bo');
% projected point
plot3(fx,fy,fz, 'b*');


% normal
plot3([ox,ox+del*nx],[oy,oy+del*ny],[oz,oz+del*nz], 'k-*');
plot3([fx,fx+del*sx],[fy,fy+del*sy],[fz,fz+del*sz], 'k-*');





axis equal;































%

% ...